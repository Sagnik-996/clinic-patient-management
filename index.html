<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Clinic Patient Management</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #4b79a1, #283e51);
        margin: 0;
        padding: 30px;
        display: flex;
        justify-content: center;
        color: white;
    }

    .container {
        width: 700px;
        background: rgba(255, 255, 255, 0.1);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 0 25px rgba(0,0,0,0.4);
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
    }

    label {
        font-weight: bold;
        display: block;
        margin-top: 10px;
    }

    input, select {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: none;
        margin-top: 5px;
    }

    .buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }

    button {
        flex: 1;
        padding: 12px;
        background: #00c6ff;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        color: black;
    }

    .queues {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .box {
        flex: 1;
        background: rgba(255,255,255,0.15);
        padding: 15px;
        border-radius: 10px;
        max-height: 300px;
        overflow-y: auto;
    }

    .patient {
        padding: 8px;
        margin-bottom: 8px;
        background: rgba(255,255,255,0.2);
        border-radius: 6px;
    }

    .small {
        font-size: 12px;
        opacity: 0.85;
    }
</style>
</head>
<body>

<div class="container">
    <h1>Clinic Patient Management</h1>

    <label>Patient Name</label>
    <input id="pname" type="text">

    <label>Age</label>
    <input id="page" type="number">

    <label>Case Type</label>
    <select id="ptype">
        <option value="normal">Normal</option>
        <option value="emergency">Emergency</option>
    </select>

    <div class="buttons">
        <button onclick="addPatient()">Add Patient</button>
        <button onclick="pingPatient()">Ping Patient</button>
        <button onclick="servePatient()">Serve Next</button>
    </div>

    <div class="queues">
        <div class="box">
            <div class="small">EMERGENCY QUEUE</div>
            <div id="emergencyQueue"></div>
        </div>
        <div class="box">
            <div class="small">NORMAL QUEUE</div>
            <div id="normalQueue"></div>
        </div>
    </div>
</div>

<script>
    let emergency = [];
    let normal = [];

    function findIndex(queue, name) {
        return queue.findIndex(p => p.name.toLowerCase() === name.toLowerCase());
    }

    function updateDisplay() {
        document.getElementById("emergencyQueue").innerHTML =
            emergency.length == 0
            ? "<div class='small'>No emergency patients.</div>"
            : emergency.map((p, i) =>
                `<div class='patient'>${i+1}. ${p.name} (Age: ${p.age})
                <div class='small'>Ping Count: ${p.ping}</div></div>`).join("");

        document.getElementById("normalQueue").innerHTML =
            normal.length == 0
            ? "<div class='small'>No normal patients.</div>"
            : normal.map((p, i) =>
                `<div class='patient'>${i+1}. ${p.name} (Age: ${p.age})
                <div class='small'>Ping Count: ${p.ping}</div></div>`).join("");
    }

    function clearInputs() {
        document.getElementById("pname").value = "";
        document.getElementById("page").value = "";
    }

    function addPatient() {
        let nameInput = document.getElementById("pname");
        let ageInput = document.getElementById("page");

        let name = nameInput.value.trim();
        let age = ageInput.value.trim();
        let type = document.getElementById("ptype").value;

        if (!name || !age) {
            alert("Enter name and age!");
            return;
        }

        let eIndex = findIndex(emergency, name);
        if (eIndex !== -1) {
            emergency[eIndex].ping++;
            alert("Patient already in EMERGENCY. Ping incremented.");
            updateDisplay();
            clearInputs();
            return;
        }

        let nIndex = findIndex(normal, name);
        if (nIndex !== -1) {
            normal[nIndex].ping++;
            if (normal[nIndex].ping >= 2) {
                emergency.push(normal[nIndex]);
                normal.splice(nIndex, 1);
                alert("Patient promoted to EMERGENCY!");
            } else {
                alert("Patient already in NORMAL. Ping incremented.");
            }
            updateDisplay();
            clearInputs();
            return;
        }

        let patient = { name, age: parseInt(age), ping: 1 };

        if (type === "emergency") emergency.push(patient);
        else normal.push(patient);

        alert("Patient added successfully.");
        updateDisplay();
        clearInputs();
    }

    function pingPatient() {
        let nameInput = document.getElementById("pname");
        let name = nameInput.value.trim();

        if (!name) {
            alert("Enter name to ping!");
            return;
        }

        let eIndex = findIndex(emergency, name);
        if (eIndex !== -1) {
            emergency[eIndex].ping++;
            alert("Pinged patient in EMERGENCY.");
            updateDisplay();
            clearInputs();
            return;
        }

        let nIndex = findIndex(normal, name);
        if (nIndex !== -1) {
            normal[nIndex].ping++;
            if (normal[nIndex].ping >= 2) {
                emergency.push(normal[nIndex]);
                normal.splice(nIndex, 1);
                alert("Pinged again â†’ PROMOTED to EMERGENCY!");
            } else {
                alert("Pinged patient in NORMAL.");
            }
            updateDisplay();
            clearInputs();
            return;
        }

        alert("Patient not found!");
        clearInputs();
    }

    function servePatient() {
        if (emergency.length > 0) {
            let p = emergency.shift();
            alert(`Treating EMERGENCY: ${p.name} (pings: ${p.ping})`);
        } else if (normal.length > 0) {
            let p = normal.shift();
            alert(`Treating NORMAL: ${p.name} (pings: ${p.ping})`);
        } else {
            alert("No patients waiting.");
        }
        updateDisplay();
    }

    updateDisplay();
</script>

</body>
</html>
